<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>اختبار اتصال الذكاء الاصطناعي</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col items-center justify-center p-4">

    <div class="bg-white p-8 rounded-3xl shadow-xl max-w-md w-full text-center">
        <h1 class="text-2xl font-black mb-6">فحص اتصال Gemini AI</h1>
        
        <div id="testStatus" class="mb-6 p-4 bg-slate-100 rounded-xl text-slate-600 font-bold">
            اضغط على الزر لإرسال طلب فحص وهمي
        </div>

        <button id="runTest" class="w-full bg-blue-600 text-white py-4 rounded-xl font-black shadow-lg hover:bg-blue-700 transition-all">
            تشغيل اختبار الاتصال الآن
        </button>

        <div id="log" class="mt-6 text-right text-xs font-mono bg-black text-green-400 p-4 rounded-lg overflow-auto max-h-40 hidden">
            جاري تشغيل السجل...
        </div>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

        // المفتاح الخاص بك للتجربة
        const API_KEY = "AIzaSyDbDukl9gI5f5LUNM5pwT5K0JhKu6-iss8";

        document.getElementById('runTest').onclick = async () => {
            const status = document.getElementById('testStatus');
            const log = document.getElementById('log');
            const btn = document.getElementById('runTest');

            status.innerText = "⏳ جاري الاتصال بجوجل...";
            status.className = "mb-6 p-4 bg-amber-100 text-amber-700 rounded-xl font-bold animate-pulse";
            log.classList.remove('hidden');
            btn.disabled = true;

            try {
                const genAI = new GoogleGenerativeAI(API_KEY);
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

                // اختبار نصي بسيط بدون صورة للتأكد من صلاحية المفتاح
                const prompt = "Say the word 'SUCCESS' if you can hear me.";
                
                log.innerHTML += "> إرسال طلب نصي للموديل...<br>";
                const result = await model.generateContent(prompt);
                const response = await result.response;
                const text = response.text();

                log.innerHTML += "> استلام الرد: " + text + "<br>";

                if (text.includes("SUCCESS")) {
                    status.innerText = "✅ نجح الاتصال! المفتاح يعمل بشكل ممتاز.";
                    status.className = "mb-6 p-4 bg-emerald-100 text-emerald-700 rounded-xl font-bold";
                } else {
                    status.innerText = "⚠️ تم الاتصال ولكن الرد غير متوقع.";
                }

            } catch (error) {
                log.innerHTML += "<span class='text-red-500'>> خطأ: " + error.message + "</span><br>";
                status.innerText = "❌ فشل الاتصال. تأكد من إعدادات المفتاح.";
                status.className = "mb-6 p-4 bg-red-100 text-red-700 rounded-xl font-bold";
                console.error(error);
            } finally {
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
